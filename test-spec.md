# テスト仕様書: Flask + OpenRouter AI 文章変換アプリ

## 1. テスト対象
- `app.py` (Flaskサーバー/APIバックエンド)
- `static/index.html` (フロントエンドUI)

## 2. テスト環境
- Windows 11
- Python 3.11.9
- Flask, openai, python-dotenv
- OpenRouter APIキー設定済み
- ブラウザ: Microsoft Edge

## 3. テスト項目

### 3.1. サーバー起動・静的ファイル配信
| No | テスト内容 | 手順 | 期待結果 | 実施結果 |
|:--:|-----------|------|---------|---------|
|  1 | サーバー起動 | `python app.py`で起動 | エラーなく起動し、`http://localhost:5000/`でアクセス可能 | エラーなく起動した |
|  2 | index.html配信 | ブラウザで`/`にアクセス | Vue.js UIが表示される | UIが表示された |

### 3.2. /send_api API 正常系
| No | テスト内容 | 手順 | 期待結果 | 実施結果 |
|:--:|-----------|------|---------|---------|
|  3 | 非空テキスト送信 | テキストを入力し「おじさん化」ボタン押下 | AIから140字以内の変換結果, 喜怒哀楽の判定結果が返る | 喜怒哀楽の判定結果は正しく返った, 変換結果としては「入力テキストそのもの」の変換結果が返るべきだが、「入力テキストに対するAIの返答」の変換結果が返ってしまうことがあった |

### 3.3. /send_api API 異常系(共通)
| No | テスト内容 | 手順 | 期待結果 | 実施結果 |
|:--:|-----------|------|---------|---------|
|  4 | 空テキスト送信 | テキストを入力せずにAPI送信 | 「エラー: Input text cannot be empty」が返る | 「エラー: Input text cannot be empty」が返った |
|  5 | textフィールドなし | index.html内のtextフィールド定義箇所をコメントアウトしてAPI送信 | 「エラー: Missing 'text' in request body」が返る | 「エラー: Missing 'text' in request body」が返った |
|  6 | APIキー未設定 | .env内のOPENROUTER_API_KEYを未設定でAPI送信 | 「エラー: OpenRouter API key is not configured on the server.」が返る | 「エラー: OpenRouter API key is not configured on the server.」が返った |

### 3.4. /send_api API 異常系(文章変換API)
| No | テスト内容 | 手順 | 期待結果 | 実施結果 |
|:--:|-----------|------|---------|---------|
|  7 | AI応答なし | ※AIから応答がない場合 | 「AIから有効な応答がありませんでした。」が返る | ※再現不可により実施せず |
|  8 | 通信エラー | Wi-FiをオフにしてAPI送信 | 「エラー: AIサービスとの通信中にエラーが発生しました。」が返る | 「エラー: AIサービスとの通信中にエラーが発生しました。」が返った |

### 3.5. /send_api API 異常系(感情判定API)
| No | テスト内容 | 手順 | 期待結果 | 実施結果 |
|:--:|-----------|------|---------|---------|
|  9 | AI応答なし | ※AIから応答がない場合 | 喜怒哀楽いずれでもない感情が返る | ※再現不可により実施せず |
| 10 | 通信エラー | Wi-FiをオフにしてAPI送信 | 喜怒哀楽いずれでもない感情が返る | 喜怒哀楽いずれでもない感情が返った |

### 3.6. UIテスト
| No | テスト内容 | 手順 | 期待結果 | 実施結果 |
|:--:|-----------|------|---------|---------|
| 11 | 初期表示 | 起動直後 | 結果欄に「ここに結果が表示されます。」と表示される, 初期画像が表示される | 結果欄に「ここに結果が表示されます。」と表示された, 初期画像が表示された |
| 12 | API応答待ち表示 | 送信後の応答待ち時 | 結果欄に「処理中...」と表示される, 応答待ち用の画像が表示される | 結果欄に「処理中...」と表示された, 応答待ち用の画像が表示された |
| 13 | 結果表示 | 応答が正常時 | 結果欄に変換結果が表示される, ユーザー入力の喜怒哀楽に対応した画像が表示される | 結果欄に変換結果が表示された, ユーザー入力の喜怒哀楽に対応した画像が表示された |
| 14 | エラー表示 | エラー発生時 | 結果欄に「エラー: ...」と表示される, エラー用の画像が表示される | 結果欄に「エラー: ...」と表示された, エラー用の画像が表示された |